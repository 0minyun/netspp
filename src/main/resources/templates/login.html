<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="https://www.ultraq.net.nz/thymeleaf/layout"
>
<script src="https://www.google.com/recaptcha/enterprise.js?render=6LfIWqYmAAAAAKzvx3iz1jngQGm3wmT9qujzQ-yr"></script>

<th:block layout:fragment="css">
  <link rel="stylesheet" th:href="@{/assets/css/landing-pages.css}">

</th:block>

<div layout:fragment="content">


  <main style="padding: 0px 10px;" >
    <header class="d-flex space-between middle-align">
      <a href="/">
        <img th:src="@{/images/logo.png}" height="50px" width="170px" alt="site logo main" style="margin: auto;"></img>
      </a>
    </header>

    <section id="login-form-section">
      <!--Login form start-->

      <div class="loginContainer d-flex direction-column">
        <!--        session 값 확인: <p th:text="${session.loginConfirm}"></p>-->
        <h2 class="formtitle">
          로그인
        </h2>
        <form action="/members/login" id="loginForm" class="d-flex direction-column" method="post" name="loginForm">

          <label th:for="email"></label>
          <input type="email"name="email" id="email" class="email" placeholder="이메일 주소 입력"/>
          <!--          <p  class="fieldError">잘못된 이메일주소 입니다..</p>-->

          <label th:for="password"></label>
          <input type="password"  name="password" id="password" placeholder="비밀번호를 입력해주세요." required/>
          <!--          <p  class="fieldError">잘못된 비밀번호입니다.</p>-->

          <button class="button submitButton" id="signInButton">로그인</button>
          <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
          <!--&lt;!&ndash;            <a style="text-decoration: none; color: white;" href="/user_dashboard/browse.html">로그인</a>&ndash;&gt;-->
          <!--&lt;!&ndash;-->


          <div class="rememberMe d-flex space-between">
            <div>
              <input type="checkbox" name="rememberMe" id="rememberMe" class="rememberMe">
              <label for="rememberMe"><span class="login-remember-me-label-text">로그인 정보 저장</span></label>
            </div>
            <a href="/members/find-id" class="findmember ms-auto">도움이 필요하신가요?</a>
          </div>

          <p class="mainsignUpText para">
            Netflix 회원이 아닌가요?<span class="mainsignUp"><a href="/members/new">&nbsp;&nbsp;&nbsp;지금 가입하세요.</a></span>
          </p>
          <p class="bottomMessage para" style="font-size: 13px;">
            이 페이지는 Google reCAPTCHA의 보호를 받아 사용자가 로봇이 아님을 확인합니다. <span style="color:royalblue; font-size: 15px;"> <a style="color:royalblue; font-size: 15px;"
                                                                                                                    href="https://policies.google.com/privacy?hl=ko">자세히알아보기.</a> </span>
          </p>
        </form>
      </div>

      <!--Login form End-->
    </section>
  </main>

  <script>
  // DOM 요소 캐시
  var errorEmailElement = document.getElementById('errorEmail');
  var errorPasswordElement = document.getElementById('errorPassword');
  var emailInputElement = document.getElementById('email');
  var signInButtonElement = document.getElementById('signInButton');
  var rememberMeCheckbox = document.getElementById('rememberMe');

  // 이메일 유효성 검사
  function validateEmail() {
    var email = emailInputElement.value;
    var re = /\S+@\S+\.\S+/;
    var result = re.test(email);
    if (result) {
      errorEmailElement.style.display = "none";
      signInButtonElement.disabled = false;
    } else {
      errorEmailElement.style.display = "block";
      signInButtonElement.disabled = true;
    }
  }

  //로컬스토리지내에 id값을 저장해놓는 코드, 로그인정보 저장 체크시에 작동
  //로그인정보저장체크를 해제하고 로그인하게되면 로컬스토리지내 키벨류 삭제
  var rememberMe = localStorage.getItem("rememberMe");
  var localStorageId = document.getElementById('email');

  window.addEventListener("load", function() {
    if (rememberMe === "true") {
      rememberMeCheckbox.checked = true;
      localStorageId.value = localStorage.getItem("localStorageId");
    }
  });

  signInButtonElement.addEventListener("click", function() {
    if (rememberMeCheckbox.checked) {
      localStorage.setItem("rememberMe", "true");
      localStorage.setItem("localStorageId", localStorageId.value);
    } else {
      localStorage.clear();
    }
  });
     function onClick(e) {
    e.preventDefault();
    grecaptcha.enterprise.ready(async () => {
      const token = await grecaptcha.enterprise.execute('6LfIWqYmAAAAAKzvx3iz1jngQGm3wmT9qujzQ-yr', {action: 'LOGIN'});
      // IMPORTANT: The 'token' that results from execute is an encrypted response sent by
      // reCAPTCHA Enterprise to the end user's browser.
      // This token must be validated by creating an assessment.
      // See https://cloud.google.com/recaptcha-enterprise/docs/create-assessment
    });
  }
</script>

</div>

</html>
